(self.webpackChunk=self.webpackChunk||[]).push([[149],{3299:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});var n=t(4015),o=t.n(n),a=t(3645),r=t.n(a)()(o());r.push([e.id,".disabled{opacity:.5;cursor:not-allowed;pointer-events:none}","",{version:3,sources:["webpack://./resources/js/Pages/Admin/Cohort/Form.vue"],names:[],mappings:"AAoMA,UACA,UAAA,CACA,kBAAA,CACA,mBACA",sourcesContent:['<template>\n  <app-layout>\n    <div class="columns is-centered">\n      <div class="column is-7-tablet is-6-desktop is-5-widescreen">\n        <inertia-link\n          class="back-link has-text-dark"\n          :href="\n            route(\'course.edit\', { course: $page.props.parameters.course })\n          "\n          >&larr; Back to course</inertia-link\n        >\n        <div class="box">\n          <h3 class="title has-text-centered">\n            {{ data ? "Modifica" : "Creare" }} classi\n            <span class="emoji">✏️</span>\n          </h3>\n          <p class="subtitle has-text-centered">\n            {{ data ? "Edit the" : "Set up a new" }} class below\n          </p>\n\n          <b-notification\n            v-if="errors.course"\n            type="is-danger"\n            has-icon\n            role="alert"\n            :closable="false"\n            :message="errors.course[0]"\n          >\n          </b-notification>\n\n          <b-tabs>\n            <b-tab-item label="Overview">\n              <b-field\n                label="Title"\n                :message="errors.title"\n                :type="errors.title ? \'is-danger\' : null"\n              >\n                <b-input\n                  required\n                  name="title"\n                  v-model="form.title"\n                  placeholder="Enter the name for this class"\n                ></b-input>\n              </b-field>\n\n              <hr />\n\n              <b-checkbox\n                @change.native="toggleActiveSubSettings"\n                v-model="form.active"\n                >Active?</b-checkbox\n              >\n              <p class="is-size-7 mb-2">\n                This will list the class as one of a student’s active classes.\n              </p>\n              <div\n                class="is-size-7 ml-4 mt-4"\n                :class="form.active ? \'\' : \'disabled\'"\n              >\n                <b-checkbox v-model="form.enable_chatroom"\n                  >Enable chatroom?</b-checkbox\n                >\n                <p class="is-size-7 mb-2">\n                  This allows students to post replies in the chatroom.\n                </p>\n\n                <b-checkbox\n                  class="mt-2"\n                  v-model="form.enables_companion_courses"\n                  >Includes access to companion classes?</b-checkbox\n                >\n                <p class="is-size-7 mb-2">\n                  This allows students enrolled in this class to access\n                  companion classes.\n                </p>\n\n                <b-checkbox\n                  class="mt-2"\n                  v-model="form.enables_speaking_club_access"\n                  >Includes access to speaking club?</b-checkbox\n                >\n                <p class="is-size-7 mb-2">\n                  This allows students enrolled on this class to access speaking\n                  club.\n                </p>\n              </div>\n\n              <hr />\n\n              <b-checkbox v-model="form.companion">Companion class?</b-checkbox>\n              <p class="is-size-7 mb-0">\n                When <strong>enabled</strong>, this class will be accessible by\n                all students enrolled in an active class that includes access to\n                companion classes.\n              </p>\n            </b-tab-item>\n            <b-tab-item v-if="$page.props.parameters.cohort" label="Students">\n              <course-users :cohort_id="$page.props.parameters.cohort" />\n\n              <div class="notification has-background-light">\n                <h3>Invite people</h3>\n                <p class="is-size-7">\n                  Share the link below with people to invite them to this class.\n                  If they don’t already have an account they\'ll be prompted to\n                  create one.\n                </p>\n                <input\n                  id="course-invite-link"\n                  class="input is-small"\n                  type="text"\n                  :value="\n                    route(\'cohort.enrollCurrentUser\', { cohort: data.hash })\n                  "\n                />\n              </div>\n            </b-tab-item>\n          </b-tabs>\n          <hr />\n          <b-button\n            type="is-primary"\n            :disabled="!form.title"\n            @click.prevent="onSubmit"\n            :loading="form.processing"\n            expanded\n            >{{ data ? "Update" : "Create" }}</b-button\n          >\n        </div>\n      </div>\n    </div>\n  </app-layout>\n</template>\n\n<script>\nimport TipTap from "@/components/TipTap";\nimport CourseUsers from "@/components/CourseUsers";\n\nexport default {\n  props: ["errors", "data"],\n  components: {\n    TipTap,\n    CourseUsers\n  },\n  data() {\n    return {\n      form: this.$inertia.form({\n        id: this.data?.id ?? null,\n        title: this.data?.title ?? null,\n        enable_chatroom: this.data?.enable_chatroom ?? false,\n        enables_companion_courses:\n          this.data?.enables_companion_courses ?? false,\n        active: this.data?.active ?? true,\n        companion: this.data?.companion ?? false,\n        enables_speaking_club_access:\n          this.data?.enables_speaking_club_access ?? false\n      })\n    };\n  },\n\n  mounted() {},\n\n  methods: {\n    toggleActiveSubSettings() {\n      this.form.enables_companion_courses = this.form.active;\n      this.form.enables_speaking_club_access = this.form.active;\n      this.form.enable_chatroom = this.form.active;\n    },\n    onSubmit() {\n      let postRoute = this.data\n        ? route("cohort.update", {\n            course: this.$page.props.parameters.course,\n            cohort: this.$page.props.parameters.cohort\n          })\n        : route("cohort.store", {\n            course: this.$page.props.parameters.course\n          });\n\n      this.form\n        .transform(data => ({\n          ...data,\n          _method: this.data ? "PUT" : "POST"\n        }))\n        .post(postRoute, {\n          preserveScroll: true,\n          onSuccess: () => {\n            this.successToast("Class saved");\n          },\n          onError: errors => {\n            this.errorToast("Check the form for errors");\n          }\n        });\n    }\n  }\n};\n<\/script>\n\n<style>\n.disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  pointer-events: none;\n}\n</style>\n'],sourceRoot:""}]);const i=r},2149:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var n=t(2971),o=t(1795);const a={props:["cohort_id"],data:function(){return{isLoaded:!1,isSaving:!1,errorLoading:!1,newUsers:[],errors:"",enrolledUsers:[],users:[],filteredUsers:this.users}},mounted:function(){var e=this;axios({method:"get",url:route("cohort.users",{cohort:this.cohort_id}),timeout:15e3}).then((function(s){e.enrolledUsers=s.data,e.isLoaded=!0})).catch((function(s){e.errorLoading=!0,axios.post("/log",{error:"COHORT ENROLLED USERS GET ERROR, ".concat(o.description,", ").concat(JSON.stringify(s))})})),axios({method:"get",url:"/users"}).then((function(s){e.users=s.data})).catch((function(s){e.errorLoading=!0,axios.post("/log",{error:"COHORT USERS GET ERROR, ".concat(o.description,", ").concat(JSON.stringify(s))})}))},watch:{isLoaded:function(){}},methods:{getFilteredUsers:function(e){this.filteredUsers=this.users.filter((function(s){return(s.first_name+" "+s.last_name).toString().toLowerCase().indexOf(e.toLowerCase())>=0||s.email.toString().toLowerCase().indexOf(e.toLowerCase())>=0}))},enrollSelected:function(){var e=this;axios({method:"post",url:route("cohort.enroll",{cohort:this.cohort_id}),data:this.newUsers.map((function(e){return e.id})),timeout:9e4}).then((function(s){e.enrolledUsers=e.enrolledUsers.concat(e.newUsers),e.newUsers=[]})).catch((function(s){e.isSaving=!1,e.displayErrorNotification(s.response.data.message),axios.post("/log",{error:"COHORT USER ENROLMENT ERROR\n".concat(o.description,"\n").concat(s.name,": ").concat(s.message,"\nReply data: ").concat(JSON.stringify(data),"\n\n")}),e.errors=s.response.data.errors||""}))},onUnenroll:function(e){var s=this;axios({method:"get",url:route("cohort.unenroll",{cohort:this.cohort_id,user:e})}).then((function(t){setTimeout((function(){s.isSaving=!1}),2e3),s.enrolledUsers=s.enrolledUsers.filter((function(s){return s.id!=e}))})).catch((function(e){s.isSaving=!1,s.displayErrorNotification(e.response.data.message),axios.post("/log",{error:"COHORT USER DELETE ERROR\n".concat(o.description,"\n").concat(e.name,": ").concat(e.message,"\nReply data: ").concat(JSON.stringify(data),"\n\n")}),s.errors=e.response.data.errors||""}))},displayErrorNotification:function(e){this.$buefy.snackbar.open({message:"<b>Error:</b> ".concat(e),type:"is-danger",position:"is-bottom",duration:5e3})}}};var r=t(1900);const i=(0,r.Z)(a,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"user-list"},[e.errorLoading?t("div",{staticClass:"notification is-danger"},[e._v("\n    An error occured while trying to load users\n  ")]):e.isLoaded?t("div",[e.users?t("b-field",{staticClass:"mt-4 mb-4"},[t("b-taginput",{attrs:{"open-on-focus":!0,data:e.filteredUsers,ellipsis:"",expanded:"",autocomplete:"","allow-new":!1,placeholder:"Add a person",field:"first_name"},on:{typing:e.getFilteredUsers},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",[e._v("\n            "+e._s(s.option.first_name)+" "+e._s(s.option.last_name)+"\n          ")]),e._v(" "),t("div",{staticClass:"is-size-7"},[e._v(e._s(s.option.email))])]}}],null,!1,3669610502),model:{value:e.newUsers,callback:function(s){e.newUsers=s},expression:"newUsers"}}),e._v(" "),t("p",{staticClass:"control"},[t("b-button",{on:{click:e.enrollSelected}},[e._v("Save")])],1)],1):e._e(),e._v(" "),e._l(e.enrolledUsers,(function(s){return t("div",{key:s.id,staticClass:"panel-block is-justify-between mb-4"},[t("div",[t("p",[e._v(e._s(s.first_name)+" "+e._s(s.last_name))]),e._v(" "),t("p",{staticClass:"is-size-7"},[e._v(e._s(s.email))])]),e._v(" "),t("button",{staticClass:"button is-small",on:{click:function(t){return e.onUnenroll(s.id)}}},[e._v("\n        Unenroll\n      ")])])}))],2):t("b-loading",{attrs:{"is-full-page":!1,active:!e.isLoaded}})],1)}),[],!1,null,null,null).exports;function c(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);s&&(n=n.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?c(Object(t),!0).forEach((function(s){u(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}function u(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}const d={props:["errors","data"],components:{TipTap:n.Z,CourseUsers:i},data:function(){var e,s,t,n,o,a,r,i,c,l,u,d,p,m;return{form:this.$inertia.form({id:null!==(e=null===(s=this.data)||void 0===s?void 0:s.id)&&void 0!==e?e:null,title:null!==(t=null===(n=this.data)||void 0===n?void 0:n.title)&&void 0!==t?t:null,enable_chatroom:null!==(o=null===(a=this.data)||void 0===a?void 0:a.enable_chatroom)&&void 0!==o&&o,enables_companion_courses:null!==(r=null===(i=this.data)||void 0===i?void 0:i.enables_companion_courses)&&void 0!==r&&r,active:null===(c=null===(l=this.data)||void 0===l?void 0:l.active)||void 0===c||c,companion:null!==(u=null===(d=this.data)||void 0===d?void 0:d.companion)&&void 0!==u&&u,enables_speaking_club_access:null!==(p=null===(m=this.data)||void 0===m?void 0:m.enables_speaking_club_access)&&void 0!==p&&p})}},mounted:function(){},methods:{toggleActiveSubSettings:function(){this.form.enables_companion_courses=this.form.active,this.form.enables_speaking_club_access=this.form.active,this.form.enable_chatroom=this.form.active},onSubmit:function(){var e=this,s=this.data?route("cohort.update",{course:this.$page.props.parameters.course,cohort:this.$page.props.parameters.cohort}):route("cohort.store",{course:this.$page.props.parameters.course});this.form.transform((function(s){return l(l({},s),{},{_method:e.data?"PUT":"POST"})})).post(s,{preserveScroll:!0,onSuccess:function(){e.successToast("Class saved")},onError:function(s){e.errorToast("Check the form for errors")}})}}};var p=t(3379),m=t.n(p),h=t(3299),b={insert:"head",singleton:!1};m()(h.Z,b);h.Z.locals;const v=(0,r.Z)(d,(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("app-layout",[t("div",{staticClass:"columns is-centered"},[t("div",{staticClass:"column is-7-tablet is-6-desktop is-5-widescreen"},[t("inertia-link",{staticClass:"back-link has-text-dark",attrs:{href:e.route("course.edit",{course:e.$page.props.parameters.course})}},[e._v("← Back to course")]),e._v(" "),t("div",{staticClass:"box"},[t("h3",{staticClass:"title has-text-centered"},[e._v("\n          "+e._s(e.data?"Modifica":"Creare")+" classi\n          "),t("span",{staticClass:"emoji"},[e._v("✏️")])]),e._v(" "),t("p",{staticClass:"subtitle has-text-centered"},[e._v("\n          "+e._s(e.data?"Edit the":"Set up a new")+" class below\n        ")]),e._v(" "),e.errors.course?t("b-notification",{attrs:{type:"is-danger","has-icon":"",role:"alert",closable:!1,message:e.errors.course[0]}}):e._e(),e._v(" "),t("b-tabs",[t("b-tab-item",{attrs:{label:"Overview"}},[t("b-field",{attrs:{label:"Title",message:e.errors.title,type:e.errors.title?"is-danger":null}},[t("b-input",{attrs:{required:"",name:"title",placeholder:"Enter the name for this class"},model:{value:e.form.title,callback:function(s){e.$set(e.form,"title",s)},expression:"form.title"}})],1),e._v(" "),t("hr"),e._v(" "),t("b-checkbox",{nativeOn:{change:function(s){return e.toggleActiveSubSettings(s)}},model:{value:e.form.active,callback:function(s){e.$set(e.form,"active",s)},expression:"form.active"}},[e._v("Active?")]),e._v(" "),t("p",{staticClass:"is-size-7 mb-2"},[e._v("\n              This will list the class as one of a student’s active classes.\n            ")]),e._v(" "),t("div",{staticClass:"is-size-7 ml-4 mt-4",class:e.form.active?"":"disabled"},[t("b-checkbox",{model:{value:e.form.enable_chatroom,callback:function(s){e.$set(e.form,"enable_chatroom",s)},expression:"form.enable_chatroom"}},[e._v("Enable chatroom?")]),e._v(" "),t("p",{staticClass:"is-size-7 mb-2"},[e._v("\n                This allows students to post replies in the chatroom.\n              ")]),e._v(" "),t("b-checkbox",{staticClass:"mt-2",model:{value:e.form.enables_companion_courses,callback:function(s){e.$set(e.form,"enables_companion_courses",s)},expression:"form.enables_companion_courses"}},[e._v("Includes access to companion classes?")]),e._v(" "),t("p",{staticClass:"is-size-7 mb-2"},[e._v("\n                This allows students enrolled in this class to access\n                companion classes.\n              ")]),e._v(" "),t("b-checkbox",{staticClass:"mt-2",model:{value:e.form.enables_speaking_club_access,callback:function(s){e.$set(e.form,"enables_speaking_club_access",s)},expression:"form.enables_speaking_club_access"}},[e._v("Includes access to speaking club?")]),e._v(" "),t("p",{staticClass:"is-size-7 mb-2"},[e._v("\n                This allows students enrolled on this class to access speaking\n                club.\n              ")])],1),e._v(" "),t("hr"),e._v(" "),t("b-checkbox",{model:{value:e.form.companion,callback:function(s){e.$set(e.form,"companion",s)},expression:"form.companion"}},[e._v("Companion class?")]),e._v(" "),t("p",{staticClass:"is-size-7 mb-0"},[e._v("\n              When "),t("strong",[e._v("enabled")]),e._v(", this class will be accessible by\n              all students enrolled in an active class that includes access to\n              companion classes.\n            ")])],1),e._v(" "),e.$page.props.parameters.cohort?t("b-tab-item",{attrs:{label:"Students"}},[t("course-users",{attrs:{cohort_id:e.$page.props.parameters.cohort}}),e._v(" "),t("div",{staticClass:"notification has-background-light"},[t("h3",[e._v("Invite people")]),e._v(" "),t("p",{staticClass:"is-size-7"},[e._v("\n                Share the link below with people to invite them to this class.\n                If they don’t already have an account they'll be prompted to\n                create one.\n              ")]),e._v(" "),t("input",{staticClass:"input is-small",attrs:{id:"course-invite-link",type:"text"},domProps:{value:e.route("cohort.enrollCurrentUser",{cohort:e.data.hash})}})])],1):e._e()],1),e._v(" "),t("hr"),e._v(" "),t("b-button",{attrs:{type:"is-primary",disabled:!e.form.title,loading:e.form.processing,expanded:""},on:{click:function(s){return s.preventDefault(),e.onSubmit(s)}}},[e._v(e._s(e.data?"Update":"Create"))])],1)],1)])])}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=149.be5b467e77b5edbf9210.js.map