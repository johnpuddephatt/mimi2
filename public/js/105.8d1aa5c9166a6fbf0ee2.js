(self.webpackChunk=self.webpackChunk||[]).push([[105],{5105:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var r=a(9680);const n={props:["stripe_public_key","payment","stripe_authentication_failure_code","$parameters"],components:{AppLayout:a(9981).Z},data:function(){return{name:"",cardElement:null,paymentProcessing:!1,paymentProcessed:!1,requiresPaymentMethod:this.payment.requires_payment_method,requiresAction:this.payment.requires_action,requiresConfirmation:this.payment.requires_confirmation,errorMessage:""}},mounted:function(){var e=this,t=document.createElement("script");t.src="https://js.stripe.com/v3",document.querySelector("head").appendChild(t),t.onload=function(){window.Stripe=Stripe(e.stripe_public_key),e.payment.is_succeeded||e.payment.is_cancelled||e.payment.requires_action||e.configureStripe()}},methods:{addPaymentMethod:function(){var e=this;this.paymentProcessing=!0,this.paymentProcessed=!1,this.errorMessage="",Stripe.confirmCardPayment(e.payment.client_secret,{payment_method:{card:e.cardElement,billing_details:{name:e.name}}}).then((function(t){e.paymentProcessing=!1,t.error?t.error.code===e.stripe_authentication_failure_code&&"payment_method_data[billing_details][name]"===t.error.param?e.errorMessage="Please provide your name.":e.errorMessage=t.error.message:r.Inertia.visit(route("billing.success"))}))},confirmPaymentMethod:function(){var e=this;this.paymentProcessing=!0,this.paymentProcessed=!1,this.errorMessage="",Stripe.confirmCardPayment(e.payment.client_secret,{payment_method:e.payment.payment_method}).then((function(t){e.paymentProcessing=!1,t.error?(e.errorMessage=t.error.message,t.error.code===e.stripe_authentication_failure_code&&e.requestPaymentMethod()):r.Inertia.visit(route("billing.success"))}))},requestPaymentMethod:function(){this.configureStripe(),this.requiresPaymentMethod=!0,this.requiresAction=!1},configureStripe:function(){var e=Stripe.elements();this.cardElement=e.create("card",{hidePostalCode:!1}),this.cardElement.mount("#card-element")}}};const s=(0,a(1900).Z)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-layout",[a("div",{staticClass:"column is-7-tablet is-6-desktop is-5-widescreen"},[a("form",{ref:"form",staticClass:"box register-form"},[e.payment.is_cancelled?a("div",[a("h3",{staticClass:"title has-text-centered"},[e._v("Payment Cancelled "),a("span",{staticClass:"emoji"},[e._v("ðŸš¦")])]),e._v(" "),a("p",{staticClass:"subtitle has-text-centered"},[e._v("This payment was cancelled.")]),e._v(" "),a("p",[e._v("The transaction has been cancelled, no payment has been taken.")]),e._v(" "),a("p",[e._v("If you did not intend to cancel the payment, please try again from the beginning.")])]):a("div",[a("h3",{staticClass:"title has-text-centered"},[e._v("Verifica necessaria "),a("span",{staticClass:"emoji"},[e._v("ðŸš¦")])]),e._v(" "),a("p",{staticClass:"subtitle has-text-centered"},[e._v("Please verify your payment")]),e._v(" "),e.errorMessage?a("b-notification",{attrs:{type:"is-danger","has-icon":"",role:"alert",closable:!1,message:e.errorMessage}}):e._e(),e._v(" "),e.paymentProcessed?e._e():a("div",{attrs:{id:"payment-elements"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.requiresPaymentMethod,expression:"requiresPaymentMethod"}]},[a("p",[e._v("We were unable to process your payment of "+e._s(e.payment.amount)+". Please try again.")]),e._v(" "),a("hr"),e._v(" "),a("b-field",{attrs:{label:"Cardholder name"}},[a("b-input",{attrs:{id:"cardholder-name",required:"",type:"text"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),a("b-field",{attrs:{label:"Card details"}},[a("div",{attrs:{id:"card-element"}})]),e._v(" "),a("button",{staticClass:"button is-primary",attrs:{id:"card-button",disabled:e.paymentProcessing},on:{click:e.addPaymentMethod}},[e._v("\n                Pay now\n              ")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.requiresAction||e.requiresConfirmation,expression:"requiresAction || requiresConfirmation"}]},[a("p",[e._v("You are about to make a payment of "+e._s(e.payment.amount)+", click the button below to proceed. You may be prompted for additional verification for security purposes.")]),e._v(" "),a("button",{staticClass:"button is-primary is-fullwidth mt-4",attrs:{id:"card-button",disabled:e.paymentProcessing},on:{click:e.confirmPaymentMethod}},[e._v("\n                Confirm payment\n              ")])])])],1)])])])}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=105.8d1aa5c9166a6fbf0ee2.js.map