(self.webpackChunk=self.webpackChunk||[]).push([[374],{4374:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var o=s(2971),n=s(1795);const a={props:["cohort_id"],data:function(){return{isLoaded:!1,isSaving:!1,errorLoading:!1,newUsers:[],errors:"",enrolledUsers:[],users:[],filteredUsers:this.users}},mounted:function(){var e=this;axios({method:"get",url:route("cohort.users",{cohort:this.cohort_id}),timeout:15e3}).then((function(t){e.enrolledUsers=t.data,e.isLoaded=!0})).catch((function(t){e.errorLoading=!0,axios.post("/log",{error:"COHORT ENROLLED USERS GET ERROR, ".concat(n.description,", ").concat(JSON.stringify(t))})})),axios({method:"get",url:"/users"}).then((function(t){e.users=t.data})).catch((function(t){e.errorLoading=!0,axios.post("/log",{error:"COHORT USERS GET ERROR, ".concat(n.description,", ").concat(JSON.stringify(t))})}))},watch:{isLoaded:function(){}},methods:{getFilteredUsers:function(e){this.filteredUsers=this.users.filter((function(t){return(t.first_name+" "+t.last_name).toString().toLowerCase().indexOf(e.toLowerCase())>=0||t.email.toString().toLowerCase().indexOf(e.toLowerCase())>=0}))},enrollSelected:function(){var e=this;axios({method:"post",url:route("cohort.enroll",{cohort:this.cohort_id}),data:this.newUsers.map((function(e){return e.id})),timeout:9e4}).then((function(t){e.enrolledUsers=e.enrolledUsers.concat(e.newUsers),e.newUsers=[]})).catch((function(t){e.isSaving=!1,e.displayErrorNotification(t.response.data.message),axios.post("/log",{error:"COHORT USER ENROLMENT ERROR\n".concat(n.description,"\n").concat(t.name,": ").concat(t.message,"\nReply data: ").concat(JSON.stringify(data),"\n\n")}),e.errors=t.response.data.errors||""}))},onUnenroll:function(e){var t=this;axios({method:"get",url:route("cohort.unenroll",{cohort:this.cohort_id,user:e})}).then((function(s){setTimeout((function(){t.isSaving=!1}),2e3),t.enrolledUsers=t.enrolledUsers.filter((function(t){return t.id!=e}))})).catch((function(e){t.isSaving=!1,t.displayErrorNotification(e.response.data.message),axios.post("/log",{error:"COHORT USER DELETE ERROR\n".concat(n.description,"\n").concat(e.name,": ").concat(e.message,"\nReply data: ").concat(JSON.stringify(data),"\n\n")}),t.errors=e.response.data.errors||""}))},displayErrorNotification:function(e){this.$buefy.snackbar.open({message:"<b>Error:</b> ".concat(e),type:"is-danger",position:"is-bottom",duration:5e3})}}};var r=s(1900);const i=(0,r.Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-list"},[e.errorLoading?s("div",{staticClass:"notification is-danger"},[e._v("\n    An error occured while trying to load users\n  ")]):e.isLoaded?s("div",[e.users?s("b-field",{staticClass:"mt-4 mb-4"},[s("b-taginput",{attrs:{"open-on-focus":!0,data:e.filteredUsers,ellipsis:"",expanded:"",autocomplete:"","allow-new":!1,placeholder:"Add a person",field:"first_name"},on:{typing:e.getFilteredUsers},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[e._v("\n            "+e._s(t.option.first_name)+" "+e._s(t.option.last_name)+"\n          ")]),e._v(" "),s("div",{staticClass:"is-size-7"},[e._v(e._s(t.option.email))])]}}],null,!1,3669610502),model:{value:e.newUsers,callback:function(t){e.newUsers=t},expression:"newUsers"}}),e._v(" "),s("p",{staticClass:"control"},[s("b-button",{on:{click:e.enrollSelected}},[e._v("Save")])],1)],1):e._e(),e._v(" "),e._l(e.enrolledUsers,(function(t){return s("div",{key:t.id,staticClass:"panel-block is-justify-between mb-4"},[s("div",[s("p",[e._v(e._s(t.first_name)+" "+e._s(t.last_name))]),e._v(" "),s("p",{staticClass:"is-size-7"},[e._v(e._s(t.email))])]),e._v(" "),s("button",{staticClass:"button is-small",on:{click:function(s){return e.onUnenroll(t.id)}}},[e._v("\n        Unenroll\n      ")])])}))],2):s("b-loading",{attrs:{"is-full-page":!1,active:!e.isLoaded}})],1)}),[],!1,null,null,null).exports;function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach((function(t){u(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const d={props:["errors","data"],components:{TipTap:o.Z,CourseUsers:i},data:function(){var e,t,s,o,n,a,r,i,l,c,u,d,p,v;return{form:this.$inertia.form({id:null!==(e=null===(t=this.data)||void 0===t?void 0:t.id)&&void 0!==e?e:null,title:null!==(s=null===(o=this.data)||void 0===o?void 0:o.title)&&void 0!==s?s:null,enable_chatroom:null!==(n=null===(a=this.data)||void 0===a?void 0:a.enable_chatroom)&&void 0!==n&&n,enables_companion_courses:null!==(r=null===(i=this.data)||void 0===i?void 0:i.enables_companion_courses)&&void 0!==r&&r,active:null===(l=null===(c=this.data)||void 0===c?void 0:c.active)||void 0===l||l,companion:null!==(u=null===(d=this.data)||void 0===d?void 0:d.companion)&&void 0!==u&&u,enables_speaking_club_access:null!==(p=null===(v=this.data)||void 0===v?void 0:v.enables_speaking_club_access)&&void 0!==p&&p})}},mounted:function(){},methods:{onSubmit:function(){var e=this,t=this.data?route("cohort.update",{course:this.$page.props.parameters.course,cohort:this.$page.props.parameters.cohort}):route("cohort.store",{course:this.$page.props.parameters.course});this.form.transform((function(t){return c(c({},t),{},{_method:e.data?"PUT":"POST"})})).post(t,{preserveScroll:!0,onSuccess:function(){e.successToast("Class saved")},onError:function(t){e.errorToast("Check the form for errors")}})}}};const p=(0,r.Z)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-layout",[s("div",{staticClass:"columns is-centered"},[s("div",{staticClass:"column is-7-tablet is-6-desktop is-5-widescreen"},[s("inertia-link",{staticClass:"back-link has-text-dark",attrs:{href:e.route("course.edit",{course:e.$page.props.parameters.course})}},[e._v("← Back to course")]),e._v(" "),s("div",{staticClass:"box"},[s("h3",{staticClass:"title has-text-centered"},[e._v("\n          "+e._s(e.data?"Modifica":"Creare")+" classi\n          "),s("span",{staticClass:"emoji"},[e._v("✏️")])]),e._v(" "),s("p",{staticClass:"subtitle has-text-centered"},[e._v("\n          "+e._s(e.data?"Edit the":"Set up a new")+" class below\n        ")]),e._v(" "),e.errors.course?s("b-notification",{attrs:{type:"is-danger","has-icon":"",role:"alert",closable:!1,message:e.errors.course[0]}}):e._e(),e._v(" "),s("b-tabs",[s("b-tab-item",{attrs:{label:"Overview"}},[s("b-field",{attrs:{label:"Title",message:e.errors.title,type:e.errors.title?"is-danger":null}},[s("b-input",{attrs:{required:"",name:"title",placeholder:"Enter the name for this class"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),s("hr"),e._v(" "),s("b-checkbox",{model:{value:e.form.enable_chatroom,callback:function(t){e.$set(e.form,"enable_chatroom",t)},expression:"form.enable_chatroom"}},[e._v("Enable chatroom?")]),e._v(" "),s("p",{staticClass:"is-size-7 mb-2"},[e._v("\n              When "),s("strong",[e._v("disabled")]),e._v(", chatrooms will not be displayed\n              within this class.\n            ")]),e._v(" "),s("b-checkbox",{model:{value:e.form.active,callback:function(t){e.$set(e.form,"active",t)},expression:"form.active"}},[e._v("Active?")]),e._v(" "),s("p",{staticClass:"is-size-7 mb-2"},[e._v("\n              When "),s("strong",[e._v("enabled")]),e._v(", this class will be listed in\n              students’ active classes and students will be able to post new\n              chatroom replies."),s("br"),e._v("\n              When "),s("strong",[e._v("disabled")]),e._v(", students will no longer be able\n              to post new chatroom replies. They will also lose access to\n              speaking club and companion classes, even if these options are\n              enabled below.\n            ")]),e._v(" "),s("b-checkbox",{model:{value:e.form.enables_companion_courses,callback:function(t){e.$set(e.form,"enables_companion_courses",t)},expression:"form.enables_companion_courses"}},[e._v("Enables access to companion classes?")]),e._v(" "),s("p",{staticClass:"is-size-7 mb-2"},[e._v("\n              When "),s("strong",[e._v("enabled")]),e._v(", students enrolled in this class\n              will be able to access companion classes while this class is\n              active.\n            ")]),e._v(" "),s("b-checkbox",{model:{value:e.form.companion,callback:function(t){e.$set(e.form,"companion",t)},expression:"form.companion"}},[e._v("Companion class?")]),e._v(" "),s("p",{staticClass:"is-size-7 mb-2"},[e._v("\n              When "),s("strong",[e._v("enabled")]),e._v(", this class will be accessible by\n              all students enrolled in an active class that includes access to\n              companion courses.\n            ")]),e._v(" "),s("b-checkbox",{model:{value:e.form.enables_speaking_club_access,callback:function(t){e.$set(e.form,"enables_speaking_club_access",t)},expression:"form.enables_speaking_club_access"}},[e._v("Includes access to speaking club?")]),e._v(" "),s("p",{staticClass:"is-size-7 mb-2"},[e._v("\n              When "),s("strong",[e._v("enabled")]),e._v(", this students enrolled on this\n              class will be able to access speaking club.\n              "),s("em",[e._v("This is only in effect while this class is active.")])])],1),e._v(" "),e.$page.props.parameters.cohort?s("b-tab-item",{attrs:{label:"Students"}},[s("course-users",{attrs:{cohort_id:e.$page.props.parameters.cohort}}),e._v(" "),s("div",{staticClass:"notification has-background-light"},[s("h3",[e._v("Invite people")]),e._v(" "),s("p",{staticClass:"is-size-7"},[e._v("\n                Share the link below with people to invite them to this class.\n                If they don’t already have an account they'll be prompted to\n                create one.\n              ")]),e._v(" "),s("input",{staticClass:"input is-small",attrs:{id:"course-invite-link",type:"text"},domProps:{value:e.route("cohort.enrollCurrentUser",{cohort:e.data.hash})}})])],1):e._e()],1),e._v(" "),s("hr"),e._v(" "),s("b-button",{attrs:{type:"is-primary",disabled:!e.form.title,loading:e.form.processing,expanded:""},on:{click:function(t){return t.preventDefault(),e.onSubmit(t)}}},[e._v(e._s(e.data?"Update":"Create"))])],1)],1)])])}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=374.29475966ecc77e353caa.js.map