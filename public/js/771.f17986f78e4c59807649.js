(self.webpackChunk=self.webpackChunk||[]).push([[771],{1771:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(9680);const n={props:["stripe_public_key","payment","stripe_authentication_failure_code","$parameters"],components:{AppLayout:s(9981).Z},data:function(){return{name:"",cardElement:null,paymentProcessing:!1,paymentProcessed:!1,requiresPaymentMethod:this.payment.requires_payment_method,requiresAction:this.payment.requires_action,requiresConfirmation:this.payment.requires_confirmation,errorMessage:""}},mounted:function(){var e=this,t=document.createElement("script");t.src="https://js.stripe.com/v3",document.querySelector("head").appendChild(t),t.onload=function(){window.Stripe=Stripe(e.stripe_public_key),e.payment.is_succeeded||e.payment.is_cancelled||e.payment.requires_action||e.configureStripe()}},methods:{addPaymentMethod:function(){var e=this;this.paymentProcessing=!0,this.paymentProcessed=!1,this.errorMessage="",Stripe.confirmCardPayment(e.payment.client_secret,{payment_method:{card:e.cardElement,billing_details:{name:e.name}}}).then((function(t){e.paymentProcessing=!1,t.error?t.error.code===e.stripe_authentication_failure_code&&"payment_method_data[billing_details][name]"===t.error.param?e.errorMessage="Please provide your name.":e.errorMessage=t.error.message:a.Inertia.visit(route("billing.success"))}))},confirmPaymentMethod:function(){var e=this;this.paymentProcessing=!0,this.paymentProcessed=!1,this.errorMessage="",Stripe.confirmCardPayment(e.payment.client_secret,{payment_method:e.payment.payment_method}).then((function(t){e.paymentProcessing=!1,t.error?(e.errorMessage=t.error.message,t.error.code===e.stripe_authentication_failure_code&&e.requestPaymentMethod()):a.Inertia.visit(route("billing.success"))}))},requestPaymentMethod:function(){this.configureStripe(),this.requiresPaymentMethod=!0,this.requiresAction=!1},configureStripe:function(){var e=Stripe.elements();this.cardElement=e.create("card",{hidePostalCode:!1}),this.cardElement.mount("#card-element")}}};const r=(0,s(1900).Z)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-layout",[s("div",{staticClass:"column is-7-tablet is-6-desktop is-5-widescreen"},[s("form",{ref:"form",staticClass:"box register-form"},[e.payment.is_succeeded?s("div",[s("h3",{staticClass:"title has-text-centered"},[e._v("Payment Successful "),s("span",{staticClass:"emoji"},[e._v("ðŸš¦")])]),e._v(" "),s("p",{staticClass:"subtitle has-text-centered"},[e._v("This payment was already successfully confirmed.")]),e._v(" "),s("p",[e._v("Some routine additional security checks were performed and your payment has now been processed successfully.")]),e._v(" "),s("inertia-link",{staticClass:"mt-4 button is-fullwidth",attrs:{href:e.route("billing.success")}},[e._v("Continue")])],1):e.payment.is_cancelled?s("div",[s("h3",{staticClass:"title has-text-centered"},[e._v("Payment Cancelled "),s("span",{staticClass:"emoji"},[e._v("ðŸš¦")])]),e._v(" "),s("p",{staticClass:"subtitle has-text-centered"},[e._v("This payment was cancelled.")]),e._v(" "),s("p",[e._v("The transaction has been cancelled, no payment has been taken.")]),e._v(" "),s("p",[e._v("If you did not intend to cancel the payment, please try again from the beginning.")])]):s("div",[s("h3",{staticClass:"title has-text-centered"},[e._v("Verifica necessaria "),s("span",{staticClass:"emoji"},[e._v("ðŸš¦")])]),e._v(" "),s("p",{staticClass:"subtitle has-text-centered"},[e._v("Please verify your payment details.")]),e._v(" "),e.errorMessage?s("b-notification",{attrs:{type:"is-danger","has-icon":"",role:"alert",closable:!1,message:e.errorMessage}}):e._e(),e._v(" "),e.paymentProcessed?e._e():s("div",{attrs:{id:"payment-elements"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.requiresPaymentMethod,expression:"requiresPaymentMethod"}]},[s("p",[e._v("Additional confirmation is needed to process your payment of "+e._s(e.payment.amount)+".")]),e._v(" "),s("p",[e._v("Please confirm your payment by filling out your payment details below.")]),e._v(" "),s("hr"),e._v(" "),s("b-field",{attrs:{label:"Cardholder name"}},[s("b-input",{attrs:{id:"cardholder-name",required:"",type:"text"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),s("b-field",{attrs:{label:"Card details"}},[s("div",{attrs:{id:"card-element"}})]),e._v(" "),s("button",{staticClass:"button is-primary",attrs:{id:"card-button",disabled:e.paymentProcessing},on:{click:e.addPaymentMethod}},[e._v("\n                    Pay now\n                ")])],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.requiresAction||e.requiresConfirmation,expression:"requiresAction || requiresConfirmation"}]},[s("button",{staticClass:"button is-primary",attrs:{id:"card-button",disabled:e.paymentProcessing},on:{click:e.confirmPaymentMethod}},[e._v("\n                    Confirm your "+e._s(e.payment.amount)+" payment\n                ")])])])],1)])])])}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=771.f17986f78e4c59807649.js.map